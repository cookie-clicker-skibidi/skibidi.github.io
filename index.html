<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FTC Event Scouting</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet" />
  <style>
    :root { font-family: 'Inter', sans-serif; }

    body { background-color: #121212; color: #e0e0e0; margin: 0; padding: 0; text-align: center; }
    h1 { font-size: 30px; margin-top: 20px; }
    table { width: 90%; margin: 20px auto; border-collapse: collapse; background-color: #1e1e1e; border-radius: 10px; overflow: hidden; }
    th, td { padding: 10px; border: 1px solid #333; text-align: center; }
    th { background-color: #292929; }
    a { color: #9cd1ff; text-decoration: none; }

    input::placeholder { text-align: center; }

    input, select, button { padding: 10px; margin: 5px; background-color: #1e1e1e; color: #e0e0e0; border: 1px solid #333; border-radius: 5px; text-align: center; font-family: 'Inter', sans-serif; }

    tr:nth-child(even) { background-color: #1b1b1b; }
    a:hover { text-decoration: underline; }

    .info { margin: 5px 0 15px; font-size: 16px; color: #ccc; }
    .input-container { margin: 20px 0; }
    .highlight { background-color: #2e004f !important; color: #bb86fc !important; font-weight: bold; }
    .sorted { background-color: #2e004f !important; }
    #loading { color: #bb86fc; margin-top: 10px; font-weight: bold; }
    .popup-container { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); display: flex; flex-direction: column; align-items: center; gap: 10px; z-index: 9999; }
    .popup { background-color: #1e1e1e; color: white; padding: 10px 20px; border: 1px solid #bb86fc; border-radius: 10px; display: flex; align-items: center; justify-content: space-between; min-width: 300px; }
    .popup span { flex: 1; text-align: center; }
    .popup button { background-color: #bb86fc; border: none; border-radius: 5px; color: black; font-weight: bold; padding: 5px 10px; cursor: pointer; }
    #footer { margin-top: 30px; font-size: 14px; color: #888; }
    .rank-green { color: #00e676; font-weight: bold; }
    .rank-yellow { color: #ffeb3b; font-weight: bold; }
    .rank-orange { color: #ff9800; font-weight: bold; }
    .warning-box { background-color: #fff3cd; color: #856404; padding: 10px 15px; margin-top: 20px; border-radius: 8px; border: 1px solid #ffeeba; display: inline-block; font-weight: 600; }
  </style>
</head>
<body>

  <h1 id="event-title">FTC Event Scouting</h1>
  <div class="info" id="event-info"></div>

  <div class="input-container">
    <input type="text" id="eventCode" placeholder="Enter event code">
    <select id="year">
      <option value="2024">2024 - Into the Deep</option>
      <option value="2023">2023 - Centerstage</option>
      <option value="2022">2022 - Power Play</option>
      <option value="2021">2021 - Freight Frenzy</option>
      <option value="2020">2020 - Ultimate Goal</option>
      <option value="2019">2019 - Skystone</option>
    </select>
    <select id="sortBy" onchange="handleSortChange()">
      <option value="tot">Total OPR</option>
      <option value="auto">Auto OPR</option>
      <option value="dc">Teleop OPR</option>
      <option value="eg">Endgame OPR</option>
    </select>
    <input type="number" id="highlightTeam" placeholder="Team # to highlight" />
    <button onclick="loadData()">Load Rankings</button>
  </div>

  <div id="no-data-warning"></div>
  <div id="loading"></div>

  <table id="rankings">
    <thead>
      <tr>
        <th>#</th>
        <th>Team</th>
        <th>Location</th>
        <th id="totHeader">Total</th>
        <th id="autoHeader">Auto</th>
        <th id="dcHeader">Teleop</th>
        <th id="egHeader">Endgame</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="info" id="total-teams"></div>
  <div class="popup-container" id="popup-container"></div>
  <div id="footer">Powered by FTCScout API</div>
<script>
document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("th").forEach(th=>{th.style.cursor="pointer"});let table=document.getElementById("rankings"),thElements=table.querySelectorAll("th"),sortDirection=Array(thElements.length).fill(true);thElements.forEach((th,i)=>{th.addEventListener("click",()=>{let rows=Array.from(table.querySelectorAll("tbody tr")),isNumeric=th.textContent==="Total"||th.textContent==="Auto"||th.textContent==="Teleop"||th.textContent==="Endgame",sortFn=isNumeric?(a,b)=>{let aText=a.children[i].textContent,bText=b.children[i].textContent,aVal=parseFloat(aText),bVal=parseFloat(bText);if(isNaN(aVal))aVal=-Infinity;if(isNaN(bVal))bVal=-Infinity;return sortDirection[i]?bVal-aVal:aVal-bVal}:(a,b)=>{let aText=a.children[i].textContent.toLowerCase(),bText=b.children[i].textContent.toLowerCase();return sortDirection[i]?aText.localeCompare(bText):bText.localeCompare(aText)};rows.sort(sortFn);let tbody=table.querySelector("tbody");rows.forEach(row=>tbody.appendChild(row));sortDirection[i]=!sortDirection[i]})})});
</script>
</body>
</html>
